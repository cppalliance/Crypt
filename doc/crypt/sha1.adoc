////
Copyright 2024 - 2025 Matt Borland
Distributed under the Boost Software License, Version 1.0.
https://www.boost.org/LICENSE_1_0.txt
////

[#sha1]
:idprefix: sha1_

= SHA1

This library supports SHA1 as described in https://datatracker.ietf.org/doc/html/rfc3174[RFC 3174].
There is a wide range of acceptable inputs for the base sha1 function:

== Hashing Object

[#sha1_hasher]
Lastly, there is also the ability to create a sha1 hashing object and feed it bytes as the user parses them.
This class does not use any dynamic memory allocation.

[source, c++]
----
namespace boost::crypt {

class sha1_hasher
{
public:
    uisng return_type = std::array<std::byte, 20>;

    // Initialize the hasher
    constexpr void init() noexcept;

    // Process bytes piecewise
    constexpr state process_bytes(std::span<const std::byte> data) noexcept;

    template <std::ranges::sized_range Range>
    constexpr state process_bytes(Range&& data) noexcept;

    // Finalize the calculation of the hash
    constexpr state finalize() noexcept;

    // Get the digest
    [[nodiscard]] constexpr return_type get_digest() noexcept;

    template <typename Range>
    BOOST_CRYPT_GPU_ENABLED state get_digest(Range&& data) noexcept
        requires std::output_range<Range, std::range_value_t<Range>> && std::sized_range<Range> && std::is_trivially_copyable_v<std::range_value_t<Range>>;
};

} // namespace boost::crypt
----

== One-Shot Hashing Functions

[source, c++]
----
namespace boost::crypt {

BOOST_CRYPT_GPU_ENABLED constexpr auto sha1(std::span<const std::byte> data) noexcept -> sha1_hasher::return_type;

template <std::ranges::sized_range SizedRange>
BOOST_CRYPT_GPU_ENABLED constexpr auto sha1(SizedRange&& data) noexcept -> sha1_hasher::return_type;

} // namespace boost::crypt
----

== File Hashing Functions

We also have the ability to scan files and return the sha1 value:

[source, c++]
----
namespace boost::crypt {

template <typename T>
    requires std::is_convertible_v<T, std::string> || std::is_convertible_v<T, std::string_view>
inline auto sha1_file(const T& filepath) -> sha1_hasher::return_type;

} // namespace boost::crypt
----
